/*! jquery asDropdown - v0.1.1 - 2014-03-28
* https://github.com/amazingSurge/jquery-asDropdown
* Copyright (c) 2014 amazingSurge; Licensed MIT */
(function(s){var t=s.dropdown=function(i,e){this.element=i,this.$element=s(i),this.$parent=this.$element.parent();var n=[];s.each(this.$element.data(),function(s,t){var i=RegExp("^asDropdown","i");i.test(s)&&(n[s.toLowerCase().replace(i,"")]=t)}),this.options=s.extend(!0,{},t.defaults,e,n),this.namespace=this.options.namespace,this.classes={skin:this.namespace+"_"+this.options.skin,show:this.namespace+"_show",trigger:this.namespace+"-trigger",mask:this.namespace+"-mask",wrapper:this.namespace+"-wrapper",panel:this.namespace+"-panel",disabled:this.namespace+"_disabled"},null!==this.options.skin&&this.$element.addClass(this.classes.skin),this.$children=this.$element.children(),this.$panel=this._parse(this.options.panel),this.isShow=!1,this.disabled=!1,this.initialized=!1,this._trigger("init"),this.init()};t.prototype={constructor:t,init:function(){var t=this;this.$parent.addClass(this.classes.wrapper),this.$element.addClass(this.namespace).addClass(this.classes.trigger),this.$panel.addClass(this.classes.panel),this.$element.on("click.asDropdown",function(){return t.toggle.call(t),!1}),this.$panel.on("click.asDropdown","li",function(){return t.set(s(this).data(t.options.data)),t.hide(),!1}),null!==this.options.select&&this.set(this.options.select),this._trigger("ready"),this.initialized=!0},_trigger:function(s){this.$element.trigger("asDropdown::"+s,this),s=s.replace(/\b\w+\b/g,function(s){return s.substring(0,1).toUpperCase()+s.substring(1)});var t="on"+s,i=arguments.length>1?Array.prototype.slice.call(arguments,1):void 0;"function"==typeof this.options[t]&&this.options[t].apply(this,i)},show:function(){var t=this;this.disabled||(this.options.clickoutHide&&this._generateMask(),s(window).on("resize.asDropdown",function(){return t._position(),!1}),this.isShow=!0,this.$element.addClass(this.classes.show),this.$panel.addClass(this.classes.show),this._position(),this._trigger("show"))},hide:function(){this.isShow=!1,this.options.clickoutHide&&this._clearMask(),this.$element.removeClass(this.classes.show),this.$panel.removeClass(this.classes.show),s(document).off("mousedown.asDropdown"),this._trigger("hide")},set:function(t){if(this.options.imitateSelect){var i=null,e=this;if(e.$panel.children().each(function(){s(this).data(e.options.data)===t&&(i=s(this))}),!i)return;this.$element.text(i.text()),this.$children.length&&this.$children.appendTo(this.$element)}this.initialized&&this._trigger("change",t)},_generateMask:function(){var t=this;this.$mask=s("<div></div>").addClass(this.classes.mask).appendTo(this.$parent),this.$mask.on("click.asDropdown",function(){return t.hide(),!1})},_clearMask:function(){this.$mask&&(this.$mask.off(".asDropdown"),this.$mask.remove(),this.$mask=null)},toggle:function(){this.isShow?this.hide():this.show()},_position:function(){var t,i,e=this.$element.offset(),n=this.$element.outerHeight(),a=this.$element.outerWidth(),o=this.$panel.outerWidth(!0),h=this.$panel.outerHeight(!0);t=h+n+e.top>s(window).height()+s(window).scrollTop()?-h:n,i=o+e.left>s(window).width()+s(window).scrollLeft()?a-o:0,this.$panel.css({position:"absolute",top:t,left:i})},_parse:function(t){return t.indexOf("+")>=0?this.$element.next():s(this.options.panel)},enable:function(){this.disabled=!1,this.$wrapper.removeClass(this.classes.disabled)},disable:function(){this.disabled=!0,this.$wrapper.addClass(this.classes.disabled)},destory:function(){this.hide(),this.$element.off(".asDropdown"),this.$element.remove(),s(window).off(".asDropdown")}},t.defaults={namespace:"asDropdown",skin:null,panel:"+",clickoutHide:!0,imitateSelect:!1,select:null,data:"value",onInit:null,onShow:null,onHide:null,onChange:null},s.fn.asDropdown=function(i){if("string"==typeof i){var e=i,n=arguments.length>1?Array.prototype.slice.call(arguments,1):void 0;return this.each(function(){var t=s.data(this,"asDropdown");"function"==typeof t[e]&&t[e].apply(t,n)})}return this.each(function(){s.data(this,"asDropdown")||s.data(this,"asDropdown",new t(this,i))})}})(jQuery);