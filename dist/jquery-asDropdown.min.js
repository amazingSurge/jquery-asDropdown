/*! jquery asDropdown - v0.1.1 - 2014-05-13
* https://github.com/amazingSurge/jquery-asDropdown
* Copyright (c) 2014 amazingSurge; Licensed MIT */
(function(t){var s=t.dropdown=function(e,i){this.element=e,this.$element=t(e),this.$parent=this.$element.parent(),this.name=this.$element.attr("name")?this.$element.attr("name"):i.name;var n=[];t.each(this.$element.data(),function(t,s){var e=RegExp("^asDropdown","i");e.test(t)&&(n[t.toLowerCase().replace(e,"")]=s)}),this.options=t.extend(!0,{},s.defaults,i,n),this.namespace=this.options.namespace,this.classes={skin:this.namespace+"_"+this.options.skin,show:this.namespace+"_show",trigger:this.namespace+"-trigger",mask:this.namespace+"-mask",wrapper:this.namespace+"-wrapper",panel:this.namespace+"-panel",disabled:this.namespace+"_disabled"},null!==this.options.skin&&this.$element.addClass(this.classes.skin),this.$children=this.$element.children(),this.$panel=this._parse(this.options.panel),this.isShow=!1,this.disabled=!1,this.initialized=!1,this._trigger("init"),this.init()};s.prototype={constructor:s,init:function(){var s=this;this.$parent.addClass(this.classes.wrapper),this.$element.addClass(this.namespace).addClass(this.classes.trigger),this.$panel.addClass(this.classes.panel),this.$element.on("click.asDropdown",function(){return s.toggle.call(s),!1}),this.$panel.on("click.asDropdown","li",function(){return s.set(t(this).data(s.options.data)),s.hide(),!1}),null!==this.options.select&&this.set(this.options.select),this._trigger("ready"),this.initialized=!0},_trigger:function(t){this.$element.trigger("asDropdown::"+t,this),this.$element.trigger(t+".asDropdown",this),t=t.replace(/\b\w+\b/g,function(t){return t.substring(0,1).toUpperCase()+t.substring(1)});var s="on"+t,e=arguments.length>1?Array.prototype.slice.call(arguments,1):void 0;"function"==typeof this.options[s]&&this.options[s].apply(this,e)},show:function(){var s=this;this.disabled||(this.options.clickoutHide&&this._generateMask(),t(window).on("resize.asDropdown",function(){return s._position(),!1}),this.isShow=!0,this.$element.addClass(this.classes.show),this.$panel.addClass(this.classes.show),this._position(),this._trigger("show"))},hide:function(){this.isShow=!1,this.options.clickoutHide&&this._clearMask(),this.$element.removeClass(this.classes.show),this.$panel.removeClass(this.classes.show),t(document).off("mousedown.asDropdown"),this._trigger("hide")},set:function(s){if(this.options.imitateSelect){var e=null,i=this;if(i.$panel.children().each(function(){t(this).data(i.options.data)===s&&(e=t(this))}),!e)return;this.$element.text(e.text()),this.$children.length&&this.$children.appendTo(this.$element)}this.initialized&&this._trigger("change",s)},_generateMask:function(){var s=this;this.$mask=t("<div></div>").addClass(this.classes.mask).appendTo(this.$parent),this.$mask.on("click.asDropdown",function(){return s.hide(),!1})},_clearMask:function(){this.$mask&&(this.$mask.off(".asDropdown"),this.$mask.remove(),this.$mask=null)},toggle:function(){this.isShow?this.hide():this.show()},_position:function(){var s,e,i=this.$element.offset(),n=this.$element.outerHeight(),a=this.$element.outerWidth(),o=this.$panel.outerWidth(!0),h=this.$panel.outerHeight(!0);s=h+n+i.top>t(window).height()+t(window).scrollTop()?-h:n,e=o+i.left>t(window).width()+t(window).scrollLeft()?a-o:0,this.$panel.css({position:"absolute",top:s,left:e})},_parse:function(s){return s.indexOf("+")>=0?this.$element.next():t(this.options.panel)},enable:function(){this.disabled=!1,this.$wrapper.removeClass(this.classes.disabled)},disable:function(){this.disabled=!0,this.$wrapper.addClass(this.classes.disabled)},destory:function(){this.hide(),this.$element.off(".asDropdown"),this.$element.remove(),t(window).off(".asDropdown")}},s.defaults={namespace:"asDropdown",skin:null,panel:"+",clickoutHide:!0,imitateSelect:!1,select:null,data:"value",name:null,onInit:null,onShow:null,onHide:null,onChange:null},t.fn.asDropdown=function(e){if("string"==typeof e){var i=e,n=arguments.length>1?Array.prototype.slice.call(arguments,1):void 0;return this.each(function(){var s=t.data(this,"asDropdown");"function"==typeof s[i]&&s[i].apply(s,n)})}return this.each(function(){t.data(this,"asDropdown")||t.data(this,"asDropdown",new s(this,e))})}})(jQuery);